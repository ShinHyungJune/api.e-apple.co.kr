# 쿠폰 관리 수정 불가 문제 해결 보고서

## 작업 일자
2025-09-12

## 문제 설명
프론트 관리자(admin.e-apple.co.kr)의 쿠폰 관리 페이지에서 쿠폰 수정 시 모든 필드가 disabled로 막혀있어 수정이 불가능한 문제

## 원인 분석
### 문제 원인
API 서버의 `CouponResource.php` 파일에서 `can_edit` 속성 로직이 반대로 구현되어 있었음
- 기존 코드: `'can_edit' => $this->users_count > 0 ? true : false,`
- 문제점: 다운로드된 쿠폰(users_count > 0)일 때 수정 가능하도록 설정됨

### 비즈니스 로직
- 다운로드되지 않은 쿠폰: 수정/삭제 가능
- 다운로드된 쿠폰: 수정/삭제 불가 (데이터 정합성 보장)

## 수정 사항

### 1. CouponResource.php 수정
**파일**: `api.e-apple.co.kr/app/Http/Resources/CouponResource.php`
**라인**: 22번째 줄

```php
// 수정 전
'can_edit' => $this->users_count > 0 ? true : false,

// 수정 후  
'can_edit' => $this->users_count === 0,
```

## 영향 범위
### 프론트엔드 (수정 불필요)
- `admin.e-apple.co.kr/components/coupons/DialogForm.vue`: `can_edit` 속성 활용 정상
- `admin.e-apple.co.kr/pages/coupons/index.vue`: 삭제 버튼 disabled 처리 정상

### 백엔드 (정상 동작 확인)
- `CouponController::update()`: 다운로드된 쿠폰 수정 방지 로직 정상
- `CouponController::destroy()`: 다운로드된 쿠폰 삭제 방지 로직 정상

## 테스트 항목
1. 다운로드되지 않은 쿠폰 수정 가능 여부 확인
2. 다운로드된 쿠폰 수정 불가 여부 확인
3. 쿠폰 삭제 버튼 활성화/비활성화 정상 동작 확인

## 결과
API 응답의 `can_edit` 로직 수정으로 문제 해결 완료